#!/bin/sh
revert() {
    $XDG_CONFIG_HOME/X11/dpms.sh
}
trap revert SIGHUP SIGINT SIGTERM

sleep 0.2 # wait for keyup before running screensaver, otherwise dpms doesn't work
xset +dpms dpms 5 5 5
xset dpms force off

if xrandr | grep -q 'DP1-1 connected'; then
    i3lock --nofork --show-failed-attempts --color 000000
else
    i3lock --nofork --show-failed-attempts --image ~/.config/i3/lockscreen.png
fi

revert
