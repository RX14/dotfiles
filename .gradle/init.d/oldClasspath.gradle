allprojects {
	afterEvaluate {
		def versions = [
			'1.6' :  "/usr/lib/jvm/java-6-jdk/jre/lib/",
			'1.7' :  "/usr/lib/jvm/java-7-jdk/jre/lib/",
			'1.8' :  "/usr/lib/jvm/java-8-jdk/jre/lib/"
		]
		
		// convert map to classpaths
		versions = versions.collectEntries { key, value ->
		    [key, fileTree(dir: value, include: "*.jar").getAsPath()]
		}

		def apply = { task ->
			if (versions.containsKey(task.targetCompatibility)) {
				task.options.fork = true;
				task.options.bootClasspath = versions[task.targetCompatibility]
			}
		}
		tasks.withType(JavaCompile, apply)
	}
}
